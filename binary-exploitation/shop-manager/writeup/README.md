# Writeup Shop Manager

Karena ada heap overflow, kita bisa dapat alamat heap dengan cara buat 2 item, edit name `item[0]` sampai overflow dan tembus price `item[1]`. Karena kena null byte, jadi perlu
edit `item[1]` dengan price menjadi -1, alamat heap akan muncul saat memanggil `listItem`. <br>
Kita juga dapat kontrol penuh di heap, tapi perlu bolak-balik `addItem` dan `editItem`. Singkatnya, kita bisa dapat berbagai leak dari heap overflow ini, termasuk libc base.<br>
Kelihatannya sulit untuk membuat ropchain di stack, karena buffer mentok pada `rbp+16` Ternyata ada gadget yang kalau kita panggil bisa membuat `rsp` pindah ke heap. Tinggal taruh ropchain di heap dan arahkan rsp ke situ. Profit.